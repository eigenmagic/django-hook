<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hooks Home</title>
</head>
<body>

<h1>Hooks</h1>
<h3>A Webhook Manager</h3>

<img src="{% static "hooks/webhooks-logo-transparent.png" %}" alt="Webhooks Logo" width="100px">

<h4>Registered webhooks</h4>

{% if webhooks %}
<table border="1">
    <tr>
        <th>Name</th>
        <th>URL</th>
        <th>View</th>
        <th>Edit</th>
    </tr>
    {% for webhook in webhooks %}
    <tr>
        <td>{{ webhook.name }}</td>
        <td>{{ webhook.url }}</td>
        <td><a href="{% url 'webhook_view' pk=webhook.pk %}">View</a></td>
        <td><a href="{% url 'webhook_edit' pk=webhook.pk %}">Edit</a></td>
    </tr>
    {% endfor %}
</table>
{% else %}
<p>No webhooks registered</p>
{% endif %}

<p>
    Webhook deleting is restricted to <a href="/admin">Admin</a>.
</p>

<h4>Register new webhooks</h4>

<a href="{% url 'webhook_new'  %}">Register</a>

<h4>Webhooks registered for events</h4>

{% if webhooks_events %}
<table border="1">
    <tr>
        <th>Event</th>
        <th>Registered webhooks</th>
    </tr>
    {% for event in events %}
    {% if webhooks_events %}
    <tr>
        <td> {{ event.name }}</td>
        <td>
            <ul>
                {% for webhook in webhooks_events|get_item:event.name %}
                <li>{{ webhook }}</li>
                {% endfor %}
            </ul>
        </td>
    </tr>
    {% endif %}
    {% endfor %}
</table>
{% else %}
<p>No events available</p>
{% endif %}

<p>
    Event editing is restricted to <a href="/admin">Admin</a>.
</p>

<h4>Trigger events</h4>

<p>
    Trigger an event to execute the registered webhooks for the event.
</p>

<ul>
    {% if events %}
    {% for event in events %}
    <li><a href="{% url 'trigger' event=event.name %}">Trigger {{ event }} event</a></li>
    {% endfor %}
    {% else %}
    <p>No events available</p>
    {% endif %}
</ul>

<p>
    <i>Please check the server logs, task queue logs and consumer logs to observe the webhook execution.<i>
</p>

</body>
</html>